document.addEventListener("DOMContentLoaded",()=>{try{const n=document.documentElement,r=document.body;function e(e){"dark"===e?(n.classList.add("dark"),localStorage.setItem("theme","dark")):(n.classList.remove("dark"),localStorage.setItem("theme","light"))}document.getElementById("theme-toggle").addEventListener("click",()=>{e("dark"===(n.classList.contains("dark")?"dark":"light")?"light":"dark")});const i=document.getElementById("lang-toggle"),a=document.querySelectorAll("[data-lang-es]");function t(e){n.setAttribute("lang",e),localStorage.setItem("language",e),a.forEach(t=>{const o=t.getAttribute(`data-lang-${e}`);o&&("TITLE"===t.tagName?t.textContent=o:t.placeholder?t.placeholder=o:t.innerHTML=o)}),function(e){const t={es:{title:"Francisco Barrientos - Ingeniero de Software y Datos",description:"Portafolio de Francisco Barrientos, Ingeniero de Software y Datos de la USACH. Ofrezco servicios de desarrollo de software, creación web, consultoría en minería y energía en Chile, y marketing digital.",ogTitle:"Francisco Barrientos - Ingeniero de Software y Datos",ogDescription:"Ingeniero de Software y Datos USACH. Desarrollo web, aplicaciones móviles, consultoría en minería y energía en Chile.",twitterTitle:"Francisco Barrientos - Ingeniero de Software y Datos",twitterDescription:"Portafolio de servicios de desarrollo de software, consultoría en minería, energía y marketing digital en Chile."},en:{title:"Francisco Barrientos - Software & Data Engineer",description:"Portfolio of Francisco Barrientos, Software and Data Engineer from USACH. I offer software development services, web creation, consulting in mining and energy in Chile, and digital marketing.",ogTitle:"Francisco Barrientos - Software & Data Engineer",ogDescription:"Software and Data Engineer from USACH. Web development, mobile applications, consulting in mining and energy in Chile.",twitterTitle:"Francisco Barrientos - Software & Data Engineer",twitterDescription:"Portfolio of software development services, consulting in mining, energy and digital marketing in Chile."}}[e];document.title=t.title;const o=document.querySelector('meta[name="description"]');o&&o.setAttribute("content",t.description);const n=document.querySelector('meta[property="og:title"]');n&&n.setAttribute("content",t.ogTitle);const r=document.querySelector('meta[property="og:description"]');r&&r.setAttribute("content",t.ogDescription);const i=document.querySelector('meta[property="og:locale"]');i&&i.setAttribute("content","es"===e?"es_CL":"en_US");const a=document.querySelector('meta[name="twitter:title"]');a&&a.setAttribute("content",t.twitterTitle);const c=document.querySelector('meta[name="twitter:description"]');c&&c.setAttribute("content",t.twitterDescription)}(e),function(e){const t={es:{"theme-toggle":"Cambiar tema","lang-toggle":"Cambiar idioma","mobile-menu-button":"Abrir menú","scroll-to-top":"Volver arriba"},en:{"theme-toggle":"Toggle theme","lang-toggle":"Change language","mobile-menu-button":"Open menu","scroll-to-top":"Back to top"}};Object.keys(t[e]).forEach(o=>{const n=document.getElementById(o);n&&n.setAttribute("aria-label",t[e][o])})}(e)}i.addEventListener("click",()=>{t("es"===(n.getAttribute("lang")||"es")?"en":"es")});const c=document.getElementById("progress-bar");const l=document.getElementById("logo-back-to-top"),s=document.getElementById("footer-back-to-top"),d=document.getElementById("scroll-to-top");function o(e){e.preventDefault(),window.scrollTo({top:0,behavior:"smooth"})}l.addEventListener("click",o),s.addEventListener("click",o),d.addEventListener("click",o);const g=document.getElementById("mobile-menu-button"),m=document.getElementById("mobile-menu");g.addEventListener("click",()=>{m.classList.toggle("hidden");const e=g.querySelector("i");e.classList.toggle("fa-bars"),e.classList.toggle("fa-times")}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){if("#"===this.getAttribute("href"))return void(this.id.includes("back-to-top")||e.preventDefault());e.preventDefault();const t=this.getAttribute("href"),o=document.querySelector(t);if(o&&(o.scrollIntoView({behavior:"smooth"}),!m.classList.contains("hidden"))){m.classList.add("hidden");const e=g.querySelector("i");e.classList.add("fa-bars"),e.classList.remove("fa-times")}})});const u=document.querySelectorAll(".blog-open-button"),h=document.querySelectorAll(".blog-close-button");u.forEach(e=>{e.addEventListener("click",()=>{const t=e.getAttribute("data-dialog"),o=document.getElementById(t);o&&(o.showModal(),r.style.overflow="hidden")})}),h.forEach(e=>{e.addEventListener("click",()=>{const t=e.closest("dialog");t&&t.close()})}),document.querySelectorAll("dialog").forEach(e=>{e.addEventListener("click",function(t){const o=e.getBoundingClientRect();o.top<=t.clientY&&t.clientY<=o.top+o.height&&o.left<=t.clientX&&t.clientX<=o.left+o.width||e.close()}),e.addEventListener("close",()=>{r.style.overflow="auto"})});const f=document.getElementById("current-year");f&&(f.textContent=(new Date).getFullYear()),function(){const t=localStorage.getItem("theme"),o=window.matchMedia("(prefers-color-scheme: dark)").matches;e(t||(o?"dark":"light")),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",t=>{localStorage.getItem("theme")||e(t.matches?"dark":"light")})}(),function(){const e=localStorage.getItem("language");t(e||"es")}(),function(){const e=atob("ZnJhbmNpc2NvLmJhcnJpZW50b3NAdXNhY2guY2w="),t=atob("KzU2OTg3NjI5NzY1");document.querySelectorAll("a[data-email]").forEach(t=>{if(t.href=`mailto:${e}`,t.textContent.includes("@")||t.textContent.toLowerCase().includes("email")){const o=t.querySelector("p");o&&(o.textContent=e)}}),document.querySelectorAll("a[data-phone]").forEach(e=>{e.href=`tel:${t}`;const o=e.querySelector("p");o&&o.textContent.includes("+")&&(o.textContent=t)})}(),window.addEventListener("scroll",()=>{!function(){const e=(r.scrollTop||n.scrollTop)/(n.scrollHeight-n.clientHeight)*100;c&&(c.style.width=e+"%")}(),n.scrollTop>300?d.classList.add("show"):d.classList.remove("show")})}catch(p){console.error("❌ Error al inicializar el sitio:",p)}}),"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/sw.js").then(e=>{console.log("✅ Service Worker registrado:",e.scope)}).catch(e=>{console.error("❌ Error al registrar Service Worker:",e)})}),window.addEventListener("error",e=>(console.error("❌ Error global capturado:",{message:e.message,filename:e.filename,lineno:e.lineno,colno:e.colno,error:e.error}),!1)),window.addEventListener("unhandledrejection",e=>{console.error("❌ Promise rechazada no manejada:",e.reason),e.preventDefault()});